fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/main/x86_64/APKINDEX.tar.gz
fetch https://dl-cdn.alpinelinux.org/alpine/v3.18/community/x86_64/APKINDEX.tar.gz
(1/6) Installing bc (1.07.1-r4)
(2/6) Installing libacl (2.3.1-r3)
(3/6) Installing libattr (2.5.1-r4)
(4/6) Installing skalibs (2.13.1.1-r1)
(5/6) Installing utmps-libs (0.1.2.1-r1)
(6/6) Installing coreutils (9.3-r2)
Executing busybox-1.36.1-r2.trigger
OK: 78 MiB in 57 packages
Running in single test mode with 5000 services
=================================================================
Starting TTFP test with 5000 services...
=================================================================
Calling teardown endpoint...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
No running test resources.
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100    27  100    27    0     0   1347      0 --:--:-- --:--:-- --:--:--  1421
=== Scaling Services to 5000 ===
Current service count: 4999
Target service count: 5000
Adding 1 services...
+ NUM_TO_ACTION=1
+ THREADS=10
+ ACTION=apply
++ kubectl get svc -A
++ grep test-svc
++ wc -l
+ NUM=4999
+ '[' apply == delete ']'
+ '[' apply == apply ']'
+ seq 4999 4999
+ xargs -P 10 -I _ sh -c 'sed '\''s/9999/_/'\'' /scripts/example.yaml | kubectl apply -f -'
service/test-svc-4999 created
/apps
Final service count: 5000
pod "loadgenerator-59d7b7cc48-rg29j" deleted
pod "prometheus-push-gateway-6qljv" deleted
pod "prometheus-push-gateway-f768f" deleted
pod "prometheus-push-gateway-x4mhl" deleted
pod "prometheus-client-0" deleted
Calling start endpoint...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  1679  100  1679    0     0  61531      0 --:--:-- --:--:-- --:--:-- 62185
Started test. 
{
    "prefix": "cali",
    "numNamespaces": 1,
    "podsPerClient": 8,
    "numClientDeployments": 8,
    "numServerDeployments": 2,
    "podsPerServer": 4,
    "tearDown": false,
    "disableCrossNamespace": false,
    "crossNamespaceOnly": false,
    "clients": {
        "nodeSelector": {
            "cloud.google.com/gke-nodepool": "default-pool"
        },
        "tolerations": null,
        "image": "gcr.io/unique-caldron-775/ttfp:v0.12.0",
        "imagePullPolicy": "IfNotPresent",
        "maxUnavailable": 1,
        "numChurns": 999999999,
        "churnTimeout": 3600000000000,
        "protocol": "tcp",
        "timeout": "",
        "url_length_factor": "",
        "connectionsPerSecond": 10,
        "expectFailConnectionsPerSecond": 10,
        "resources": {
            "requests": {
                "cpu": "10m"
            }
        }
    },
    "servers": {
        "nodeSelector": {
            "cloud.google.com/gke-nodepool": "default-pool"
        },
        "tolerations": null,
        "image": "nginx:1.19.6",
        "imagePullPolicy": "IfNotPresent",
        "maxUnavailable": 1,
        "numChurns": 999999999,
        "churnTimeout": 3600000000000,
        "resources": {
            "requests": {
                "cpu": "10m"
            }
        },
        "readinessProbe": {
            "httpGet": {
                "path": "/",
                "port": 80,
                "scheme": "HTTP"
            }
        }
    },
    "policies": {
        "randomPolicy": {
            "batchSize": 0,
            "numBatches": 0
        },
        "enableActivePolicyChurn": false,
        "enableAppLayerPolicy": false
    }
}
Attempt 1 of 5 to get TTFP 99th percentile TTFP_VALUE...
TTFP 99th percentile: 1.28424202951s
SUCCESS: TTFP startup time is within the acceptable range (1.28424202951 seconds)
=== Recording calico-node startup time ===
=== Calico Node Startup Time Measurement ===
Namespace: calico-system
Label Selector: k8s-app=calico-node
Target Node: glen-bz-iir5-kadm-node-0.us-central1-a.c.tigera-dev.internal
Acceptable Startup Time: 60s

=== Collecting Cluster Information ===
Kubernetes Version: v1.33.5

=== Calico Configuration ===
Dataplane Mode: Iptables
Encapsulation Type: IPIP
BGP Enabled: Enabled
IP Pool CIDR: 192.168.0.0/16

=== Cluster Scale Metrics ===
Total NetworkPolicies: 2017
Total Services: 5049
Total Ready Nodes: 504

=== Tigera Status ===

Shortened Tigera Status:
NAME                          AVAILABLE   PROGRESSING   DEGRADED   SINCE
apiserver                     True        False         False      21h
calico                        True        False         False      20m
intrusion-detection           True        False         False      21h
ippools                       True        False         False      21h
log-collector                 True        False         False      21h
log-storage                   True        False         False      21h
log-storage-access            True        False         False      21h
log-storage-dashboards        True        False         False      21h
log-storage-elastic           True        False         False      21h
log-storage-esmetrics         True        False         False      21h
log-storage-kubecontrollers   True        False         False      21h
log-storage-secrets           True        False         False      21h
manager                       True        False         False      21h
monitor                       True        False         False      21h
policy-recommendation         True        False         False      21h
tiers                         True        False         False      21h

Full Tigera Status (YAML):
      message: All objects available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-10-28T17:55:10Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Progressing
- apiVersion: operator.tigera.io/v1
  kind: TigeraStatus
  metadata:
    creationTimestamp: "2025-10-28T17:52:55Z"
    generation: 1
    name: monitor
    resourceVersion: "2722882"
    uid: aeb0d306-9a5f-402b-80a1-a0851025ae7c
  spec: {}
  status:
    conditions:
    - lastTransitionTime: "2025-10-29T14:53:00Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Degraded
    - lastTransitionTime: "2025-10-28T17:53:40Z"
      message: All objects available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-10-28T17:53:40Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Progressing
- apiVersion: operator.tigera.io/v1
  kind: TigeraStatus
  metadata:
    creationTimestamp: "2025-10-28T17:52:55Z"
    generation: 1
    name: policy-recommendation
    resourceVersion: "5636"
    uid: b06e0bd2-24eb-4abe-ad4f-4aa19f11916f
  spec: {}
  status:
    conditions:
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Degraded
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All objects available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Progressing
- apiVersion: operator.tigera.io/v1
  kind: TigeraStatus
  metadata:
    creationTimestamp: "2025-10-28T17:52:55Z"
    generation: 1
    name: tiers
    resourceVersion: "5637"
    uid: c3ee6bbe-357f-4971-b333-5ac821f2bc5e
  spec: {}
  status:
    conditions:
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      reason: AllObjectsAvailable
      status: "False"
      type: Degraded
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All objects available
      reason: AllObjectsAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      reason: AllObjectsAvailable
      status: "False"
      type: Progressing
kind: List
metadata:
  resourceVersion: ""

=== Starting Calico Node Restart Test ===
Found pod: calico-node-z4hv6 on node glen-bz-iir5-kadm-node-0.us-central1-a.c.tigera-dev.internal
Deleting pod calico-node-z4hv6...
pod "calico-node-z4hv6" deleted
Waiting for new pod on node glen-bz-iir5-kadm-node-0.us-central1-a.c.tigera-dev.internal...
New pod detected: calico-node-6rt8w
Pod created at: 2025-10-29T15:15:02Z (epoch: 1761750902)
Waiting for pod calico-node-6rt8w to become Ready...
    uid: b06e0bd2-24eb-4abe-ad4f-4aa19f11916f
  spec: {}
  status:
    conditions:
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Degraded
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All objects available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      observedGeneration: 1
      reason: AllObjectsAvailable
      status: "False"
      type: Progressing
- apiVersion: operator.tigera.io/v1
  kind: TigeraStatus
  metadata:
    creationTimestamp: "2025-10-28T17:52:55Z"
    generation: 1
    name: tiers
    resourceVersion: "5637"
    uid: c3ee6bbe-357f-4971-b333-5ac821f2bc5e
  spec: {}
  status:
    conditions:
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      reason: AllObjectsAvailable
      status: "False"
      type: Degraded
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All objects available
      reason: AllObjectsAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-10-28T17:53:50Z"
      message: All Objects Available
      reason: AllObjectsAvailable
      status: "False"
      type: Progressing
kind: List
metadata:
  resourceVersion: ""

=== Starting Calico Node Restart Test ===
Found pod: calico-node-z4hv6 on node glen-bz-iir5-kadm-node-0.us-central1-a.c.tigera-dev.internal
Deleting pod calico-node-z4hv6...
pod "calico-node-z4hv6" deleted
Waiting for new pod on node glen-bz-iir5-kadm-node-0.us-central1-a.c.tigera-dev.internal...
New pod detected: calico-node-6rt8w
Pod created at: 2025-10-29T15:15:02Z (epoch: 1761750902)
Waiting for pod calico-node-6rt8w to become Ready...
pod/calico-node-6rt8w condition met

========================================
DaemonSet pod calico-node-6rt8w became Ready in 35 seconds.
Calico-node startup time: 35s
========================================

========================================
CALICO NODE STARTUP TEST RESULTS
========================================
Cluster Information:
  Kubernetes Version: v1.33.5
  Total Ready Nodes: 504

Calico Configuration:
  Dataplane Mode: Iptables
  Encapsulation: IPIP
  BGP Enabled: Enabled

Cluster Scale:
  Total NetworkPolicies: 2017
  Total Services: 5049

Performance:
  Calico-node startup time: 35s
========================================

✅ SUCCESS: calico-node-6rt8w startup time is within the acceptable range (35 seconds < 60s)
=== Calico-node startup time recorded successfully ===

========================================
TEST SUMMARY
========================================
Service Count: 5000
TTFP 99th Percentile: 1.28424202951s
Acceptable TTFP Time: 4s
========================================

=== End Results ===

All TTFP tests completed successfully!
Stream closed EOF for default/scale-platform-provider-ttfp-test-run-5k-services-iptables64m7l (tester)
